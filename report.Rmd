---
title: "Academy turnover and wastage analysis"
output:
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include=FALSE}
source("R/functions.R")
source("R/data_analysis.R")
library(knitr)
library(tidyr)
library(ggpubr)
library(scales)
library(purrr)
```

## Scope 

This analysis aims to understand the effect of academies, the process of academisation and being part of a multi academy trust on turnover and wastage.

The analysis follows these four stages: 

**1. General turnover and wastage trends between academies and non-academies -** quantifying the difference between turnover and wastage between Local Authorities maintained schools and Academies. 

**2. Turnover and wastage trends relative to years in a trust -** explaining how wastage and turnover changes relative to the years in trust. In particular answering the following:

 - Is there an immediate change in staffing that contributes to higher academy turnover?
 - Is there a general sustained change in turnover and wastage rates that we can attribute to academy status?
 - How does this differ for sponsored and converter academies?
 
**3. Staffing and stuctural changes - ** understanding the profiles of staff that are leaving academies post conversion compared with those that are replacing them? In particular answering the following:

- Which part of a school changes the most? Leadership? Classroom teachers?
- Are experienced higher paid teachers being replaced by less experienced lower paid teachers?

**4. Analysis of within MAT movement of teachers - ** focussing on MATs only seeking to understand the rates of teacher movement within trusts and the types of movement. In particular answering the following:

- What proportion of turnover of schools in MATs is within MAT turnover?
- For those that move what proportion leave on promotion?
- Are teachers from successful converter academies being moved to sponsored academy to support school improvement?

## Background

A change in school system through the establishment of academies, which are publicly funded independent schools, started in early 2000 and became significant after 2010. In terms of their governance, academies are run by an academy trust which employs the staff. Some academies are "empty MATs" or SAT, set up as single academy trust with just one school, but most are part of a Multi-Academy Trusts.  

There are two types of academies: sponsored and converter. Initially the aim was to improve pupil performance (in sponsored academies); however, the scope expanded in 2010 to those wanting more independence from local authority control (in converter academies
). 

```{r prop_prim_sec, message = FALSE, echo = FALSE, include = FALSE}

get_perc_acads <- function(data, year, phase, variable_interest) {
  year <- enquo(year)
  phase <- enquo(phase)
  variable_interest <- enquo(variable_interest)
  data %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>% 
  mutate(School_type = if_else(Academy_type == "Non-Academies", "LA Maintained", "Academy")) %>%
  group_by(CensusYear, SchoolPhase_Grouped, School_type) %>%
  count() %>%
  ungroup() %>% 
  spread(School_type, n) %>% 
  mutate(Percentage_academies = Academy/ (Academy + `LA Maintained`)) %>% 
  filter(CensusYear == !!year & SchoolPhase_Grouped == !!phase) %>% 
  select(!!variable_interest) %>% 
  sum() 
}

prim_2010 <- get_perc_acads(schools, 2010, "Primary", Percentage_academies)
prim_2018 <- get_perc_acads(schools, 2018, "Primary", Percentage_academies)
sec_2010 <- get_perc_acads(schools, 2010, "Secondary", Percentage_academies)
sec_2018 <- get_perc_acads(schools, 2018, "Secondary", Percentage_academies)

prim_n2010 <- get_perc_acads(schools, 2010, "Primary", Academy)
prim_n2018 <- get_perc_acads(schools, 2018, "Primary", Academy)
sec_n2010 <- get_perc_acads(schools, 2010, "Secondary", Academy)
sec_n2018 <- get_perc_acads(schools, 2018, "Secondary", Academy)
```

#### The percentage of secondary academies - of all secondary schools - increased from `r percent(sec_2010)` (`r sec_n2010`) to `r percent(sec_2018)` (`r sec_n2018`) in 2018. For primary academies, `r percent(prim_2010)` (`r prim_n2010`) increased to `r percent(prim_2018)` (`r prim_n2018`) in 2018.  

Academisation has been a large scale system change within the schools system since 2010. As of 2018 academies make up the majority of secondary schools and a growing proportion of primary schools. In numerical terms there are a higher number of primary academies but this is a small proportion of all primary schools.

```{r academies_perc_schools, message = FALSE, echo = FALSE, warnings = FALSE, fig.width = 10, fig.height = 5}
schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>% 
  mutate(School_type = if_else(Academy_type == "Non-Academies", "LA Maintained", "Academy")) %>%
  group_by(CensusYear, SchoolPhase_Grouped, School_type) %>%
  count() %>%
  ungroup() %>% 
  spread(School_type, n) %>% 
  mutate(Percentage_academies = round(Academy / (Academy + `LA Maintained`), digits = 4)) %>% 
  ggplot(aes(x = CensusYear, y = Percentage_academies, fill = SchoolPhase_Grouped)) +
  geom_bar(stat = "identity", position = "dodge") +
  xlab("") +
  ylab("") + 
  ggtitle("Percentage Academies Over Time") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.1)) +
  geom_text(aes(label= round(Percentage_academies*100, digits = 1)), 
            position = position_dodge(width=0.9), vjust=-0.25) +
  scale_x_continuous(breaks = seq(2010, 2018, 1))
  
```


```{r min_max_perc,  message = FALSE, echo = FALSE, include = FALSE}

turn_wast_nat_fig <- function(input_calc, input_cy, input_schoolphase_grouped){
  
  turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  group_by(CensusYear, SchoolPhase_Grouped) %>%
  summarise(
    `Percentage Turnover` = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE),
    `Percentage Wastage` = sum(Wastage* TOTFTE, na.rm = TRUE)/sum(QTStatus* TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>% 
  gather(key = "Calculation", value = "Percentage", -CensusYear, -SchoolPhase_Grouped) %>% 
  mutate(Percentage = round(Percentage, digits = 3)) %>% 
  filter(
    Calculation == input_calc,
    CensusYear == input_cy,
    SchoolPhase_Grouped == input_schoolphase_grouped
    ) %>%
  pull(Percentage)
  
}

pri_2010_turn <- turn_wast_nat_fig("Percentage Turnover", 2010, "Primary")
pri_2017_turn <- turn_wast_nat_fig("Percentage Turnover", 2017, "Primary")
sec_2010_turn <- turn_wast_nat_fig("Percentage Turnover", 2010, "Secondary")
sec_2017_turn <- turn_wast_nat_fig("Percentage Turnover", 2017, "Secondary")

pri_2010_wast <- turn_wast_nat_fig("Percentage Wastage", 2010, "Primary")
pri_2017_wast <- turn_wast_nat_fig("Percentage Wastage", 2017, "Primary")
sec_2010_wast <- turn_wast_nat_fig("Percentage Wastage", 2010, "Secondary")
sec_2017_wast <- turn_wast_nat_fig("Percentage Wastage", 2017, "Secondary")

```

#### National turnover saw an upward trend between 2010 and 2014 and reduced thereafter. Wastage has seen a general upward trend increasing by over 2ppt for both primary and secondary since 2010. 

Annual turnover increased increased from `r percent(pri_2010_turn)` in 2010 for primary to `r percent(pri_2017_turn)` in 2017. For secondary, it increased from `r percent(sec_2010_turn)` to `r percent(sec_2017_turn)`.

Annual wastage increased increased from `r percent(pri_2010_wast)` in 2010 for primary to `r percent(pri_2017_wast)` in 2017. For secondary, it increased from `r percent(sec_2010_wast)` to `r percent(sec_2017_wast)`.

```{r census_background_turnover, echo=FALSE, fig.width = 10, fig.height = 6}
turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  group_by(CensusYear, SchoolPhase_Grouped) %>%
  summarise(
    `Percentage Turnover` = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE),
    `Percentage Wastage` = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>% 
  gather(key = "Calculation", value = "Percentage", -CensusYear, -SchoolPhase_Grouped) %>% 
  mutate(Percentage = round(Percentage, digits = 3)) %>%
  ggplot(aes(x = CensusYear, y = Percentage, fill = Calculation)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_bw() +
  facet_wrap(~ SchoolPhase_Grouped, ncol = 1) + 
  ylab("") +
  xlab("") +
  ggtitle("Yearly Average Turnover and Wastage Rates") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(2010,2017,1)) +
  scale_y_continuous(limits = c(0, 0.15), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = Percentage*100), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)
```

## 1. General turnover and wastage trends between academies and non-academies

This section illustrates general trends for academies and non-academies over time. It does not explain how turnover has changed before and after the conversion but it gives an overarching view of patterns. 

```{r avg_turnover_type, message = FALSE, echo = FALSE, include = FALSE}
pri_2017_turn_diff_spon_main <- turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary")) %>%
  group_by(CensusYear, School_Type) %>%
  summarise(
    Per_Turnover = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  filter(School_Type %in% c("Sponsored Academies", "Non-Academies") ) %>%
  select(School_Type, CensusYear, Per_Turnover) %>% 
  spread(School_Type, Per_Turnover) %>% 
  mutate(Difference = `Sponsored Academies`- `Non-Academies`) %>%
  filter(CensusYear == 2017) %>% 
  pull(Difference) 

sec_2017_turn_diff_spon_main <- turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Secondary")) %>%
  group_by(CensusYear, School_Type) %>%
  summarise(
    Per_Turnover = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  filter(School_Type %in% c("Sponsored Academies", "Non-Academies") ) %>%
  select(School_Type, CensusYear, Per_Turnover) %>% 
  spread(School_Type, Per_Turnover) %>% 
  mutate(Difference = (`Sponsored Academies`- `Non-Academies`)) %>%
  filter(CensusYear == 2017) %>% 
  pull(Difference)

```

#### Turnover in sponsored academies is consistently higher than LA maintained schools and converter academies. In 2017 turnover was `r percent(pri_2017_turn_diff_spon_main, suffix = "ppt")` higher in academies than in LA maintained schools at primary and `r percent(sec_2017_turn_diff_spon_main, suffix = "ppt")` at secondary.

As a general feature, sponsored academies have higher turnover than converter academies and non-academies. With the exception of converter academies in 2010, the average turnover for all schools (academies and non-academies) has an upward trend before 2013 - 2014. After that, this pattern declines or flattens. 
 
```{r census_turnover, echo = FALSE, fig.width = 10, fig.height = 6}

turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  group_by(CensusYear, School_Type, SchoolPhase_Grouped) %>%
  summarise(
    Per_Turnover = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>% 
  mutate(Per_Turnover = round(Per_Turnover, digits = 3)) %>%
  ggplot(aes(x = CensusYear, y = Per_Turnover, fill = School_Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_bw() +
  facet_wrap(~ SchoolPhase_Grouped, ncol = 1) + 
  ylab("% Turnover") +
  ggtitle("Turnover in academies and LA maintained schools over time") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(2010,2017,1)) +
  scale_y_continuous(limits = c(0, 0.2), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = Per_Turnover*100), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)
  
```

```{r avg_wastage_type, message = FALSE, echo = FALSE, include = FALSE}
pri_2017_wast_diff_spon_main <- turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary")) %>%
  group_by(CensusYear, School_Type) %>%
  summarise(
    Per_Wastage = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  filter(School_Type %in% c("Sponsored Academies", "Non-Academies") ) %>%
  select(School_Type, CensusYear, Per_Wastage) %>% 
  spread(School_Type, Per_Wastage) %>% 
  mutate(Difference = `Sponsored Academies`- `Non-Academies`) %>%
  filter(CensusYear == 2017) %>% 
  pull(Difference)

sec_2017_wast_diff_spon_main <- turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Secondary")) %>%
  group_by(CensusYear, School_Type) %>%
  summarise(
    Per_Wastage = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  filter(School_Type %in% c("Sponsored Academies", "Non-Academies") ) %>%
  select(School_Type, CensusYear, Per_Wastage) %>% 
  spread(School_Type, Per_Wastage) %>% 
  mutate(Difference = `Sponsored Academies`- `Non-Academies`) %>%
  filter(CensusYear == 2017) %>% 
  pull(Difference)

```

#### Wastage in sponsored academies is consistently higher than LA maintained schools and converter academies. In 2017 turnover was `r percent(pri_2017_wast_diff_spon_main, suffix = "ppt")` higher in academies than in LA maintained schools at primary and `r percent(sec_2017_wast_diff_spon_main, suffix = "ppt")` at secondary.

Sponsored academies have a higher wastage rate than converter academies and non-academies.  Wastage rates in sponsored academies fluctuate in both primary and secondary schools, whilst in converter academies and LA maintained schools wastage rates have an upward trend.

```{r census_wastage, echo = FALSE, fig.width = 12, fig.height = 7}
turn_wast_teachers %>% 
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  group_by(CensusYear, School_Type, SchoolPhase_Grouped) %>%
  summarise(
    Per_Wastage = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  mutate(Per_Wastage = round(Per_Wastage, digits = 3)) %>%
  ggplot(aes(x = CensusYear, y = Per_Wastage, fill = School_Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_bw() +
  facet_wrap(~ SchoolPhase_Grouped, ncol = 1) + 
  ylab("% Wastage") +
  ggtitle("Wastage in academies and LA maintained schools over time") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(2010,2017,1)) +
  scale_y_continuous(limits = c(0, 0.15), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = Per_Wastage*100), size = 2.5, 
            position = position_dodge(width = 0.9), vjust = -0.25)

```

#### At school level, the percentages of turnover and wastage have a wide range (from 0% to 100%) and a high number of outliers. This is partially due to the larger variety of percentages in small schools, with fewer than 50 teachers.  

Although there is a lot of overlap between categories of schools, sponsored academies have higher medians than non-academies and converter academies for all census years as per box plots below: 

```{r boxplot_turnover, echo = FALSE, fig.width = 10, fig.height = 10}

turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  ggplot(aes(x = as.factor(CensusYear), y = Per_Turnover, fill = School_Type)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  xlab("") + 
  ylab("% Turnover") +
  ggtitle("School turnover percentages distribution") +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) 

```

```{r boxplot_wastage, echo=FALSE, fig.width = 10, fig.height = 10}

turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  ggplot(aes(x = as.factor(CensusYear), y = Per_Wastage, fill = School_Type)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  xlab("") + 
  ylab("% Wastage") +
  ggtitle("School wastage percentages distribution") +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) 

```

#### Sponsored Academies have comparable turnover to Ofsted 4 LA maintained schools from 2012 onwards with the exception of 2017 Secondary.

Ofsted 4 LA maintained schools have comparable turnover to sponsored academies at both primary and secondary. This fluctuates between years with ofsted 4 having higher turnover in some years and sponsored academies in others. We see a large difference in 2017 for secondary which may be due to the reduced sample of secondary LA maintained schools.

```{r bar_chart_sponsored_underachieving, warnings = FALSE, echo = FALSE, fig.width = 10, fig.height = 10}
turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  mutate(TTestGroups = case_when(
    School_Type == "Sponsored Academies" ~ "Sponsored",
    School_Type == "Non-Academies" & OfstedOverallScore == 4 ~ "Ofsted 4 Maintained",
    TRUE ~ "Exclude"
  )) %>%
  filter(TTestGroups != "Exclude") %>%
  group_by(CensusYear, TTestGroups,SchoolPhase_Grouped) %>%
  summarise(
    Per_Turnover = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  ggplot(aes(x = CensusYear, y = Per_Turnover, fill = TTestGroups)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  ylab("% Turnover") +
  ggtitle("Turnover in sponsored academies compared with ofsted 4 LA maintained schools.") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(2010,2017,1)) +
  scale_y_continuous(limits = c(0, 0.2), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = round(Per_Turnover*100,1)), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)

```

There is a lot of overlap between percentages of turnover for sponsored academies and LA maintained schools with 4 Ofsted rating.

```{r boxplot_sponsored_underachieving, warnings = FALSE, echo = FALSE, fig.width = 10, fig.height = 10}
turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  mutate(TTestGroups = case_when(
    School_Type == "Sponsored Academies" ~ "Sponsored",
    School_Type == "Non-Academies" & OfstedOverallScore == 4 ~ "Ofsted 4 Maintained",
    TRUE ~ "Exclude"
  )) %>%
  filter(TTestGroups != "Exclude") %>%
  ggplot(aes(x = as.factor(CensusYear), y = Per_Turnover, fill = TTestGroups)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  ylab("% Turnover") +
  ggtitle("School level turnover in sponsored Academies compared with ofsted 4 LA maintained schools") +
  theme(legend.position = "bottom", legend.title = element_blank(), 
        axis.text.x = element_text(face = "bold", size = 8, angle = 0)) +
  xlab("") +
  theme(plot.title = element_text(hjust = 0.5))

```

#### Sponsored Academies have comparable wastage to Ofsted 4 LA maintained schools from 2012 onwards with the exception of 2017 primary.

Making the same comparison of sponsored academies with ofsted 4 LA maintained schools highlights a similar pattern in wastage. This again fluctuates over time and has a large exception of 2017 primary.

```{r bar_chart_sponsored_underachieving_w, warnings = FALSE, echo = FALSE, fig.width = 10, fig.height = 10}
turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  mutate(TTestGroups = case_when(
    School_Type == "Sponsored Academies" ~ "Sponsored",
    School_Type == "Non-Academies" & OfstedOverallScore == 4 ~ "Ofsted 4 Maintained",
    TRUE ~ "Exclude"
  )) %>%
  filter(TTestGroups != "Exclude") %>%
  group_by(CensusYear, TTestGroups,SchoolPhase_Grouped) %>%
  summarise(
    Per_Wastage = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  ggplot(aes(x = CensusYear, y = Per_Wastage, fill = TTestGroups)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  ylab("% Wastage") +
  ggtitle("Wastage in sponsored academies compared with ofsted 4 LA maintained schools.") +
  theme_bw() +
  theme(legend.position = "bottom", legend.title = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(2010,2017,1)) +
  scale_y_continuous(limits = c(0, 0.2), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = round(Per_Wastage*100,1)), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)

```

There is once more a wide range of school level wastage rates and large overlap between percentages of wastage for sponsored academies and LA maintained schools with 4 Ofsted rating.

```{r boxplot_sponsored_underachieving_w, warnings = FALSE, echo = FALSE, fig.width = 10, fig.height = 10}
turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  mutate(TTestGroups = case_when(
    School_Type == "Sponsored Academies" ~ "Sponsored",
    School_Type == "Non-Academies" & OfstedOverallScore == 4 ~ "Ofsted 4 Maintained",
    TRUE ~ "Exclude"
  )) %>%
  filter(TTestGroups != "Exclude") %>%
  ggplot(aes(x = as.factor(CensusYear), y = Per_Turnover, fill = TTestGroups)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  ylab("% Wastage") +
  ggtitle("School level wastage in sponsored academies compared with ofsted 4 LA maintained schools.") +
  theme(legend.position = "bottom", legend.title = element_blank(), 
        axis.text.x = element_text(face = "bold", size = 8, angle = 0)) +
  xlab("") +
  theme(plot.title = element_text(hjust = 0.5))

```

## 2. Turnover and wastage trends relative to years in a trust

This section looks to understand how wastage and turnover change relative to the time that an academy is in a trust. In most cases this is the equivalent of time school existed as an academy, with the exception of schools that have been re-brokered to a new trust.

As we have seen previously, academy converter and LA maintained schools exhibit similar turnover and wastage rates. Of core interest here is how turnover and wastage changes for sponsored academies relative to years in trust. As sponsored academies are a route for school improvement we would be looking for a reduction in turnover and wastage over time.

#### Sponsored academies see a general downward trend in teacher turnover relative to their years in trust. Sponsored Academies in their 5th year still have a turnover rate over 2ppt higher than LA maintained schools.

Sponsored academies see a general downward trend in turnover relative to the years that the school has been in its academy trust. There is a peak in year 3 which may suggest delayed changes to staffing. Compared to sponsored academies in their first year, those in their 5th year see a 2ppt or more reductions in turnover.

Compared with LA maintained schools there is still a substantial difference (over 2ppt) in turnover for academies in their 5th year. For reference, 2017 turnover was `r percent(pri_2017_turn)` at Primary and `r percent(sec_2017_turn)` at Secondary.

```{r years_turnover, echo = FALSE, fig.width = 10, fig.height = 5}
turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  filter(!is.na(TrustID) & School_Type != c("Non-Academies")) %>%
  filter(CensusYear == 2017) %>%
  group_by(YearInTrust, School_Type, SchoolPhase_Grouped) %>%
  summarise(
    Per_Turnover = sum(Turnover * TOTFTE, na.rm = TRUE)/sum(TOTFTE, na.rm = TRUE)
    ) %>%
  ungroup() %>%
  mutate(Per_Turnover = round(Per_Turnover, digits = 3)) %>%
  filter(YearInTrust <= 5) %>%
  ggplot(aes(x= YearInTrust, y = Per_Turnover, fill = School_Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_bw() +
  facet_wrap(~ SchoolPhase_Grouped, ncol = 1) +
  theme(legend.position = "bottom", legend.title = element_blank() ) +
  xlab("Years in trust") +
  ylab("% Turnover") +
  ggtitle("2017 Academy turnover based on years in trust") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(0, 5, 1)) +
  scale_y_continuous(limits = c(0, 0.2), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = Per_Turnover*100), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)

```

There is a lot of overlap between percentages of turnover for sponsored and converter academies, although sponsored academies are generally higher than converter academies in both primary and secondary schools. 

```{r boxplot_yrs_trust_turnover, echo = FALSE, fig.width = 10, fig.height = 10}

turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  filter(YearInTrust <= 5) %>%
  filter(CensusYear == 2017) %>%
  ggplot(aes(x = as.factor(YearInTrust), y = Per_Turnover, fill = School_Type)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  xlab("") + 
  ylab("% Turnover") +
  ggtitle("2017 School level academy turnover based on years in Trust") +
  theme(legend.position = "bottom", legend.title = element_blank())

```

#### Sponsored academies see a general downward trend in teacher wastage relative to their years in trust. Sponsored Academies in their 5th year still have a wastage rate over 1.5ppt higher than LA maintained schools.

Sponsored academies see a general downward in wastage relative to the years in trust, again reducing by over 2ppt when comparing schools in their 1st year vs schools in 5th year.

Compared with LA maintained schools there is again a difference (over 1.5ppt) in wastage for academies in their 5th year. For reference, 2017 wastage was `r percent(pri_2017_wast)` at Primary and `r percent(sec_2017_wast)` at Secondary.

```{r years_wastage, echo = FALSE, fig.width = 10, fig.height = 7}
turn_wast_teachers %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  filter(!is.na(TrustID) & School_Type != c("Non-Academies")) %>%
  filter(CensusYear == 2017) %>%
  group_by(YearInTrust, School_Type, SchoolPhase_Grouped) %>%
  summarise(
    Per_Wastage = sum(Wastage * TOTFTE, na.rm = TRUE)/sum(QTStatus * TOTFTE, na.rm = TRUE)
    ) %>%
  ungroup() %>%
  mutate(Per_Wastage = round(Per_Wastage, digits = 3)) %>%
  filter(YearInTrust <= 5) %>%
  ggplot(aes(x= YearInTrust, y = Per_Wastage, fill = School_Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_bw() +
  facet_wrap(~ SchoolPhase_Grouped, ncol = 1) +
  theme(legend.position = "bottom", legend.title = element_blank() ) +
  xlab("Years in trust") +
  ylab("% Wastage") +
  ggtitle("2017 Academy wastage based on years in trust") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(0, 5, 1)) +
  scale_y_continuous(limits = c(0, 0.2), breaks = seq(0,0.3,0.1), labels = scales::percent) +
  geom_text(aes(label = Per_Wastage*100), size = 3, 
            position = position_dodge(width = 0.9), vjust = -0.25)
```

There is a lot of overlap between percentages of turnover for sponsored and converter academies, although sponsored academies are generally higher than converter academies in both primary and secondary schools. 

```{r boxplot_yrs_trust_wastage, echo=FALSE, fig.width = 10, fig.height = 10}

turn_wast_schools %>%
  filter(SchoolPhase_Grouped %in% c("Primary", "Secondary")) %>%
  filter(YearInTrust <= 5) %>%
  ggplot(aes(x = as.factor(YearInTrust), y = Per_Wastage, fill = School_Type)) +
  geom_boxplot() +
  facet_wrap(SchoolPhase_Grouped ~ ., ncol = 1) + 
  theme_bw() +
  xlab("") + 
  ylab("% Wastage") +
  ggtitle("2017 School level academy wastage based on years in trust") +
  theme(legend.position = "bottom", legend.title = element_blank())

```
